\chapter{Machine Learning}



\section{Learning Objectives}


\begin{itemize}
\item Understand the strength and limitations of machine learning
\item Distinguish  unsupervised learning,  supervised learning,  reinforcement learning, and transfer
  learning
\end{itemize}

\section{Decision Problems}

\index{decision problem}


\subsection{Bring an Umbrella or not?}

Machine learning means using computer programs to discover patterns
(i.e., ``learn'') from data. How is this different from typical
computer programs?  Let us consider a {\it decision problem}:
Should you bring an umbrella or not?  This should be easy, right?


\begin{verbatim}
If it is raining then
   Bring an umbrella
Otherwise
   

% YHL: I have problems using 
% \usepackage{algorithmic} or
% \usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\end{verbatim}

This is simple enough.  If you always follow this rule, you will soon
encounter situations when this rule is not good.  Maybe it is not raining
right now but it is expected to rain soon. Thus, you add one more rule:

\begin{verbatim}
If it is raining then
   Bring an umbrella
Otherwise
   If it is expected to rain soon then
      Bring an umbrella
   Otherwise
      Do not bring an umbrella
\end{verbatim}



If you follow these rules, you will soon discover that they are still
insufficient.  If you are going to walk in covered areas (such as
subway stations or shopping malls), maybe you do not need an umbrella.
Thus, you add another rule:

\begin{verbatim}
If it is raining and you will walk outside covered areas then
   Bring an umbrella
Otherwise
   If it is expected to rain soon and walk outside covered areas then
      Bring an umbrella
   Otherwise
      Do not bring an umbrella
\end{verbatim}

If you are carrying a box and it does not rain heavily, maybe you
do not want to take an umbrella because it is inconvenient to carry
the box and to hold an umbrella at the same time. As a result,
the rules become

\begin{verbatim}
If it is raining and you will walk outside covered areas then
   If carrying a box and the rain is light then
       Do not bring an umbrella
   Otherwise
       Bring an umbrella
Otherwise
   If it is expected to rain soon and walk outside covered areas then
      Bring an umbrella
   Otherwise
      Do not bring an umbrella
\end{verbatim}

The rules become more and more complex.  You may also want to consider
whether it is windy. If it is, you may want to wear a raincoat instead
of bringing an umbrella. If you want to ride a bike, you may want to
choose a rain coat instead of an umbrella.  Maybe it is very hot and
you want to walk in rain to cool.  As you can see, this decision
problem has so many different scenarios and writing all these {\tt
  if}-{\tt else} conditions becomes really complex.

\subsection{Cross a Stree Intersection?}

If you drive a car, should you cross a street intersection or not?
You may think this is really easy:

\begin{verbatim}
If the traffic light is green then
   Cross the intersection
Otherwise
   Do not cross the intersection
\end{verbatim}

Sometimes, you cannot enter the inserction because it is blocked
by vehicles already. If you enter the intersection, you will park
at the intersection and worsen traffic jam. Thus, you add another rule:

\begin{verbatim}
If the traffic light is green and the intersection is clear then
   Cross the intersection
Otherwise
   Do not cross the intersection
\end{verbatim}

If you hear the siren of an ambulance, you should allow it to pass first.
Consequently, the rule gets more complex:

\begin{verbatim}
If the traffic light is green and the intersection is clear and there is no siren then
   Cross the intersection
Otherwise
   Do not cross the intersection
\end{verbatim}

If there is a jaywalker, you don't want to hit the person. Let's add that into the rule:

\begin{verbatim}
If the traffic light is green and the intersection is not occupied 
 and no siren and no jaywalker then
   Cross the intersection
Otherwise
   Do not cross the intersection
\end{verbatim}

If there is a construction and a flagman, you should follow the
flagman's instruction, not the traffic light.  

\begin{verbatim}
If a flagman signals to cross the intersection then
   Cross the intersection
Otherwise
   If the traffic light is green and the intersection is clear 
     and no siren and no jaywalker then
       Cross the intersection
   Otherwise
       Do not cross the intersection
\end{verbatim}

We can keep adding more and more rules to cover many different
scenarios.  As you can see, this decision problem may consider many
factors and writing down these rules become increasingly complex and
difficult.

\index{mortgage}
\subsection{Approve a Mortgate Application?}

If you are a bank manager and evaluate mortgage applications, how do
you decide whether to approve or not?  If you approve the application
and the person pays regularly, your bank makes money from fees and
interests.  If the person fails to pay (called ``defaults''), the bank
may lose money. It is possible that the bank does not lose money
if the house's value is sufficient to cover the mortgage (through
foreclosure). Foreclosure can be a lengthy process and most banks want
to avoid it.  How do you decide? Maybe you decide based on the
person's regular income: \index{default} \index{foreclosure}


\begin{verbatim}
If the montly income is great than twice of the monthly payment then
   Approve the mortgate application
Otherwise
   Deny the mortgate application
\end{verbatim}

If you do this, your bank will likely lose a lot of money because you
need to consider other factors, for example, whether the person
already has a lot of debt. You probably also want to consider whether
this person has a record of failing to pay bills.  If the house is not
in a popular location, you definitely want to avoid the possibility of
foreclosure. If the person has been doing business with the bank for
several years, you would trust this person more than a new customer.
Do you want to consider whether this person already own one or more
houses?  Should you consider this person's age?  Would the marital
status affect your decision?  You may want to consider the economy as
well. If economy is strong, this applicant is likely to keep the
current job or even get a raise; thus, this applicant is likely to pay
the mortgage. If economy is weak, this applicant may lose the current
job and fails to pay.  If you want to consider many factors, are some
factors are more important than the others? How do you choose the
important factors?  This problem, again, shows that considering many
factors and writing down the rules become increasingly complex and
difficult.

\section{Decisions and Feedback}

In our everyday life, we make hundreds of decisions: what clothes to
wear, where to go for lunch, what to buy in a store, what birthday
gift to send to a friend, etc.  The previous examples show that
decision problems often need to consider many factors.  The reason we
need to consider many factors is to prevent making wrong decisions.
What are ``wrong'' decisions? If you bring an umbrella and it does not
rain, it is a wrong decision.  If you do not bring an umbrella and it
rain heavily, it is a wrong decision.  Some wrong decisions have
negligible consequences: bringing an umbrella (if it is small and
light) without using it may not be a big problem.  Some wrong
decisions can have dire consequences: approving a mortgage and it
defaults, the bank loses a lot of money, possibly 
millions of dollars.

What is a ``wrong'' decision? It may not be so obvious.  A bank may
deny all mortgage applications that have slight chances of
defaults. This may completely avoid defaults but the bank also loses
opportunities making money from the applications that may, but do not,
default.  In this case, ``preventing defaults'' and ``making money''
are two related but different goals.

After knowing the consequences of a decision, we may conclude that it
is a right or a wrong decision. This is the {\it feedback} of the
decision.  With the feedback, we hope to make better decisions in the
future. For example, if the bank approves a mortgage and it defaults,
the bank would probably deny the next application that is ``similar''
to the defaulted one.  The problem is how to determine two mortgage
applications are ``similar''.

For some problems, it is impossible (or almost impossible) to know
whether a wrong mistake has been made. Suppose you are a bank manager
and you deny a mortgage application. You will not know whether this
person would be able to pay mortgage regularly because you have denied
the application.


\index{feedback}

\section{Knowledge in Data}

\index{infer}
\index{pattern}

The examples described earlier are decision problems: whether to bring
an umbrella, whether to approve a mortgage application, etc. Each
problem needs to consider many factors and it is not clear which
factor is more than the other. One way to solve these problems is to
examine similar scenarios in the past and their results: if the
current mortgage application is ``similar'' to one that approved in
the past, was that approval a right decisoin (i.e., did not default)?
Instead of writing rules, this new approach uses past data to guide
future decisions.  This is what {\it machine learning} can be helpful:
computer programs discover (i.e., ``learn'') patterns from data.  Past
data may help decide which factors are important for making decisions
{\it if the past data and the new decision problem have similar
  patterns.}  Having the same pattern is an essential assumption in
machine learning.  Think about how humans learn: a person observes
something and then when the person sees {\it similar} things, the
person uses past knowledge and experience to {\it infer} what that new
things are.  If a person sees something that is dissimilar to
everything seen before, this person is unable to recognize the
patterns and what it is.

Machine learning relies on the assumption that past observations and
new, unseen, situations have similar patterns.  This assumption is
essential to the success of machine learning.  Imagine that you are
the bank manager and have discovered a good way to determine whether
to approve or deny mortgage applications.  If you move to another city
or another country, your method may be wrong more often than you
expected. Maybe the demographics are different. Maybe the cultural
norms are different.  Maybe the real estate markets are different.
This indicates that your machine learning method has its limitations.
You may need to add some more factors into consideration.

\index{limit of machine learning}

\index{supervised learning}
\index{unsupervised learning}
\index{reinforcement learning}
\index{reward}


\section{Supervised, Unsupervised, and Reinforcement Learning}

There are different types of
learning~\cite{Goodfellow2016DeepLearning,
  Sutton2017ReinforcementLearningIntroduction}.  {\it Supervised
  learning} means that there is a ``teacher'' telling a ``student''
what is right or wrong. Imagine that a teacher shows images of flowers
and tell students that these are flowers. The teacher shows another
image of an elephant and says that it is an elephant.  {\it
  Unsupervised learning} has no teacher. Imagine that you want to
stock your store on a Friday evening for sales on Saturday.  There is
no correct answer what merchandize you should put on shelves.  You can
analyze the past sales records, together with factors such as weather
and season.  You may also want to consider whether there is a major
sport event on that Saturday.  This is different from supervised
learning because there is no teacher telling you ``Yes, you should
stock this item on shelves.''  or ``No, do not stock that item because
few people will buy it this coming Saturday.''  Unsupervised learning
is often used to discover (unknown) properties in data, for example,
what people buy on a Saturday.  The third type of learning is called
{\it reinforcement learning}.  It considers sequences of actions (such
as moves in chess) and the {\it rewards} (such as winning a chess
game) of these actions.  Consider playing chess as an example.
Reinforcement learning is different from supervised learning because
most decisions cannot be consider right or wrong. Some decisions such
as checkmate are obviously right decisions but the effects of most
decisions are unkonwn until much later. Instead, the sequence of
decisions leads to a result, either winning or losing. Reinforcement
learning is usually used for developing strategies solving problems
through sequences of actions.  Sutton and Barto said, ``The most
important feature distinguishing reinforcement learning from other
types of learning is that it uses training information that evaluates
the actions taken rather than instructs by giving correct
actions.''~\cite{Sutton2017ReinforcementLearningIntroduction}.
Table~\ref{table:threetypesoflearning} summarizes the three types of
learning.

\vspace{0.1in}
\begin{table}
  \begin{tabular}{p{1.2in}p{1.2in}p{1.2in}p{1.2in}}
    &    {\bf Supervised} & {\bf Unsupervised} & {\bf Reinforcement} \\
    \hline
    Teacher & Yes & No & No \\
    Correct Answer & Yes & No & No \\
    Consider Sequences & No & No & Yes \\
    Applications & Answer Yes/No & Cluster data & Develop strategies \\
  \end{tabular}
  \caption{Three types of learning}
  \label{table:threetypesoflearning}
\end{table}
\vspace{0.1in}

Supervised learning may be the most familar form of learning for many
people: babies learn parents' faces when the parents say ``Daddy'' and
``Mommy''.  Students learn from teachers in classrooms.  Supervised
learning, however, can be expensive because teachers are needed.  As
computer technologies improve, acquiring data becomes very easy and
inexpensive.  Spending \$100, you can buy a video camera and the it
can easily generate thousands of images (more precisely, video frames)
per day. Teachig computer the information in the images requires
humans as teachers because computer programs cannot perfectly analyze
images yet.  Teaching computers by marking what is in the images is
called {\it labeling} or {\it annnotating}.  In some cases, labeling
can be {\it crowdsourced}.  Labeling one million images can take more
than one year~\cite{imagenet}.  \index{crowdsourced} In some other
cases, the ``teachers'' of computers must have special qualifications;
for example, medical images are evaluated by trained medical doctors.
\index{visual data}
\index{label}
\index{annotating}

\index{transfer learning}

Yet another type of learning is called {\it transfer learning}.  In
transfer learning, the sample data for learning and the test data have
different patterns.  The knowledge learned from the sample data is
``transferred'' to a new set of test data.  An analogy is that a
person learns English and then uses the knowelege about sentence
structures and tenses to learn French. Transfer learning can be very
useful if there are many examples in the first set of data and much
fewer examples in the second set of data.


\begin{comment}
http://incompleteideas.net/book/bookdraft2017nov5.pdf
Reinforcement Learning: An Introduction
Richard S. Sutton and Andrew G. Barto
\end{comment}



\index{definition of learning}
    {\bf Definition of Learning}

  We have talked about ``learning'' without actually defining it.
  What is learning? Michelle~\cite{Mitchell1997MachineLearning}
  defines

  
  
  {\it
    A computer program is said to learn from experience E with respect
    to some class of tasks T and performance measure P, if its
    performance at tasks in T, as measured by P, improves with
    experience E.}

  

  To explain this in a more intuitive way, a computer program can
  learn if it can ``get better'' by doing something more.  One way to
  understand learning is by comparing it with something that cannot
  learn. Consider the calculator program on your computer (or your
  mobile phone). It does not get better after you use it.  In
  contrast, a program that determines whether an email is spam may get
  better after you mark some emails as
  spam~\cite{Hastie2009ElementsStatisticalLearning}.  By marking spam
  emails, you play the role of a teacher and this is an example of
  supervised learning.




This definition does not speficy what is ``experience''.  From
computers' viewpoint, the experience often refers to ``data''.  If
more data is used (assuming the data follows specific patterns), then
the computer program can perform better (such as making more correct
decisions in mortgage applications).

What is {\it machine learning} really?  Machine learning is pretty
broad (and somewhat vague).  In this book (and many other books),
machine learning refers to {\it statistical learning} or {\it
  data-driven discovery}: finding information from data.  Successful
machine learning often requires vast amounts of data to learn from.
Machine learning discovers {\it patterns} in the data and uses the
patterns to {\it predict} or {\it infer} that unseen data has the same
(or similar) patterns.  For example, a computer program may discover
that a person has a high debt-income ratio is likely to default in a
mortgage.  If a future mortgage applicant has a high debt-income
ratio, the program could suggest denying the application due to the
higher risk.

More rigorously, machine learning aims to discover
a model $\mathcal{M}$ 

\section{Limitations of Machine Learning}

Machine learning is not perfect; machine learning has some
limitations.  First, what can be learned depends on the input data. If
some important pieces of data are missing (for example, there are no
cases of high debt-income ratios), then the computer program cannot
learn.  To think of this in a different way, a person that grows up
inland and has never seen a cargo ship will thus not know existence of
cargo ships.  Second, it is difficult to determine when the data is
``sufficient'' or ``representative''.  The patterns are unknown
(otherwise, there is no need to learn) so it is hard to tell when
there is enough data to discover the patterns.  Third, the data may be
``biased'' and the it is not easy to define success. Imagine that you
are designing a machine learning program to diagnose a rare illness.
If a person has this illness, the program says ``Yes''; otherwise, the
program says, ``No''.  Suppose the probability is one out of 100,000
people.  The program would be 99.999\% accurate if it always says
``No''.  However, this high accuracy does not really help.

Fourth, each machine learning program reflects a specific {\it model}
that is designed to recognize the patterns in the data.  Different
models have different capabilities: some models can recognize complex
patterns and some others cannot.  This is an analogy about models'
capabilities: humans are the only known species that can handle
written communications.  Some other animals can communicate in sound
that is not understood by humans. It is not yet clear whether humans
will ever be able to understand the sound.  Maybe human brains are
incapable of learning the sound.

\index{black swan event}

    {\bf Black Swan Event}

    
  A {\it black swan event} is something that has never been seen
  before and thus considered
  impossible~\cite{Taleb2010BlackSwan}.  People
  used to believe that swans must be white. Apparently, it is not
  possible to learn and infer the existence of a black swan.

  
  Black swan events are everywhere, if you pay close attention.
  Before 1969/07/20, nobody could expect that a man would be able to
  walk on the moon. Before April 2010, nobody would expect a volcano
  eruption could cause worldwide disruption of air travel.  Before the
  first iPhone was announced, there was no iPhone. Before Michael
  Phelps won 28 Olympic medals, nobody had won 28 Olympic medals.


  If something has been observed, it is definitely possible.  After a
  black swan has been seen, people know that swans can be black.  If
  something has not been observed, it is difficult to say whether it
  is impossible or not. Maybe it can be observed later.



  Even though black swan events cannot be inferred  from known patterns,
  it is possible to predict the occurrence {\it by some people} that
  are willing to challenge these patterns and consider
  possibilities that have no been observed (i.e., learned). This
  is where {\it imagination} and {\it creativity} come in.
  This book focuses on learning  and does not discuss imagination or
  creativity further.

  \index{imagination}
  \index{creativity}
    
  


Sidebar about precision and recall.

\index{statistical learning}
\index{data-driven discovery}
\index{infer}
\index{predict}
\index{data bias}
\index{model}

\section{Applications of Machine Learning}

As explained earlier, machine learning can be used when many factors
need to be considered.  Machine learning has already been used in many
applications~\cite{Alpaydin2010IntroductiontoMachine}, such as
improving customer relationships, making financial decisions,
diagnosize illness, identify spam emails, recognize speeches and
objects in images.

\vspace{0.1in}

\index{computer vision}

    {\bf Computer Vision (not sure it belongs here, maybe move to
    somewhere later}


  Computer vision is the technologies understanding what is in

 The
technologies intend to solve many different types of problems, for
example,

 Classification of the content: Is the visual data taken indoor
  or outdoor?  Is this a sport event?  Is this downtown or forest?

 Object Detection: Does the visual data contain a car, a person,
  a bridge, a computer, or something else?  Where is the detected
  object?

 Action: Is a person playing tennis? Are two people talking?
  Is that airplane taking off?

 Emotion: Is a peron happy, sad, bored?





